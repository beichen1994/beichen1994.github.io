---
title: 深度学习基础
date: 2019-12-17 08:03:53
tags:
- neural network and deep learning
categories: 
- Computer
---

&ensp;&ensp;在了解并学习机器学习时，我对深度学习这个词有非常大的疑惑，到底什么才是深度学习？深度学习到底有多深？这个问题非常可笑。后来我阅读了[Python深度学习](https://book.douban.com/subject/30293801/)这本书，这本书是由Keras之父François Chollet所写，对初学者比较友好，而且采用的是Keras框架，该框架基于Tensorflow，学习起来也不难。这本书我只读了一部分，整理笔记如下。

* * *

1.张量
* ndim：轴/阶的个数
* shape：形状
* dtype：数据类型，unit8，float32，float64,char

| 类型 |  |
| --- | --- |
| 2维张量|样本轴、特征轴|
| 3维张量(序列数据)|样本轴、时间轴、特征轴|
| 4维张量(图像数据)|样本轴、高度轴、宽度轴、颜色深度轴|
| 5维张量(视频数据)|样本轴、帧轴、高度轴、宽度轴、颜色深度轴|

2.层

| 张量|层  |keras  |
| --- | --- | --- |
| 2维张量|dense layer(密集层)|keras的Dense类|
| 3维张量(序列数据)|recurrent layer(循环层)|keras的LSTM层|
| 4维张量(图像数据)|二维卷积层|keras的conv2D|

* * *

神经网络的流程并不复杂，如下图所示
[![QICEiF.md.jpg](https://s2.ax1x.com/2019/12/17/QICEiF.md.jpg)](https://imgchr.com/i/QICEiF)

* * *
工作流程

* 问题类型：二分类、多分类、标量回归、向量回归、聚类、强化学习
* 衡量指标：精度、准确率、召回率
* 评估方法：留出验证集、k折交叉验证、重复的k折验证
* 数据预处理
1 向量化：数据->张量
2 标准化：对每个特征分别标准化，使其均值为0，方差为1
3 处理缺失值：将缺失值设置为0
4 特征工程：对数据进行硬编码转换，以便于模型进行学习

* 构建模型

|  | 最后一层激活 | 损失函数 | 优化器 |
| --- | --- | --- | --- |
| 二分类 | sigmoid | binary_crossentropy | rmsprop/默认的学习率 |
| 多分类单标签 | softmax | categorical_crossentropy |  |
| 多分类多标签 | sigmoid | binary_crossentropy |  |
| 回归到任意值 | 无 | mse |  |
| 回归到0~1 | sigmoid | mse或binary_crossentropy |  |

* 开发过拟合模型 
1 添加更多的层
2 让每一层参数变多
3 训练更多的轮次
要始终监控训练损失和验证损失，以及训练指标值和验证指标值
* 模型正则化与调节超参数
1 添加dropout正则（在训练过程中随机将该层的一些输出特征设置为0）
2 添加权重正则化（强制让模型权重只能取较小的值。向网络损失函数中添加与较大权重值相关的成本）L1正则（添加的成本与权重系数的绝对值成正比）L2正则（添加的成本与权重系数的平方成正比）
3 增加或减少层数
4 尝试不同的超参数(每层的单元个数、优化器的学习率)
5 反复特征工程(添加新特征或删除没有信息量的特征

