---
title: 爬虫之4正则表达式
date: 2020-02-07 23:47:38
tags:
- 爬虫
categories: 
- Computer
---


## 正则表达式
非python独有，re模块实现

###### 位置：
^匹配字符串开头
$匹配字符串末尾
()匹配括号内表达式
######  字符：
\w匹配**字母** **数字** **下划线**
\d匹配**任意数字**
\s匹配**空白字符**
.匹配**任意字符(除换行符)**
######  次数：
{n}精准匹配n次
？匹配0次或1次
+匹配至少一个
*匹配至少0个

## re.match()

```
re.match(pattern,string,flags=0)
```
从字符串的开头匹配给定的模式，若该字符串不匹配，则返回none

```
import re

content = "hello 123 4567 world_this is a regex demo"
print(len(content))
result=re.match('^hello\s\d\d\d\s\d{4}\s\w{10}.*demo$',content)
print(result)
print(result.group())
print(result.span())
```


## re.search()
从字符串的开头匹配给定的模式，并返回第一个成功的匹配
```
import re

content = "extra strings hello 1234567 world_this is a regex demo"
result=re.search('hello.*?(\d+).*?demo$',content)
print(result)
```

## 总结：
为匹配方便，能用search就不用match

## re.findall()
从字符串开头匹配给定的模式，以列表形式返回所有匹配
## re.sub()
替换字符串中每一个匹配的子串后返回替换后的字符串
```
import re

content = 'extra strings hello 1234567 world_this is a regex demo'
content=re.sub('\d+','',content)
print(content)
```
## re.compile()
将正则字符串编译成正则表达式对象
```
import re

content='hello 1234567 world_this is a regex demo'
pattern=re.compile('hello.*demo',re.S)
result=re.match(pattern,content)
print(result)
```


## 贪婪匹配
.匹配任意字符（除换行符）
*匹配至少0个字符
.\* 匹配最长的

```
import re

content = "hello 1234567 world_this is a regex demo"

result=re.match('^he.*(\d+).*demo$',content)
print(result)
print(result.group())
print(result.span())
```

## 非贪婪匹配
.匹配任意字符（除换行符）
\*匹配至少0个字符
?匹配0个或1个
.*? 匹配最短的

```
import re

content = "hello 1234567 world_this is a regex demo"

result=re.match('^he.*?(\d+).*demo$',content)
print(result)
print(result.group())
print(result.span())
```

## 匹配模式
re.S 将\n作为普通的字符加入到字符串中
group(1) 返回第一组

```
import re

content = '''hello 1234567 world_this
is a regex demo
'''
result=re.match('^he.*?(\d+).*?demo$',content,re.S)
print(result)
print(result.group(1))
```

## 总结：
尽量使用非贪婪匹配，有换行符就用re.S


## 匹配演练
```
import re

html='''<div id=songs-list>
    <h2 class='title'>经典老歌<\h2>
    <p class='introduction'>经典老歌列表</p>
    <ul id="list" class="list-group">
        <li data-view="1">一路上有你</li>
        <li data-view="2">
            <a href="/2.mp3" singer="任贤齐">沧海一声笑</a>
        </li>
        <li data-view="3" class='active'>
            <a href="/3.mp3" singer="齐秦">往事随风</a>
        </li>
        <li data-view="4"><a href="/4.mp3" singer="beyond">光辉岁月</a></li>
        <li data-view="5"><a href="/5.mp3" singer="陈慧琳">记事本</a></li>
        <li data-view="6"><a href="/6.mp3" singer="邓丽君">但愿人长久</a></li>
    </ul>
    </div>
'''
result = re.search('<li.*?active.*?singer="(.*?)">(.*?)</a>',html,re.S)
if result:
    print(result.group(1),result.group(2))
```
